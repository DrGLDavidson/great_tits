# ðŸ“¦PACKAGES ----
library(lme4)
library(lmerTest)
library(rptR)
library(Matrix)
library(tidyverse) # a range of helpful packages
library(janitor)# helps to format the data
library(kableExtra)
library(performance)# needed to instal for the stats graphs (posterior check)
library(ggExtra)
library(broom.mixed) # broom tables
library(patchwork)
library(GGally)
library(gt)
#_________________-----
# LOADING IN DATA
setwd("~/GitHub/great_tits/data") # setting the path
tsm<- read.csv(file= "final_data_edit.csv", header=TRUE) # inserting the new data
final_data_glm<-tsm %>%
select(RFID, Count_may, Date, Hmsec, CounterID, nestbox, year, latency, repeat_birds, sex, Age2019BreedingSeason, Age2020BreedingSeason, Age2021BreedingSeason, ageFinal, number_fledged, site_box_number)
names(final_data_glm) #
rep2 <- rpt(latency ~sex + ageFinal + year+ (1|nestbox)+ (1 | RFID), grname = "RFID", data = final_data_glm,
datatype = "Gaussian", nboot = 1000, npermut = 0)
print(rep2)
summary(rep2)
model4<-lmer(number_fledged ~ sex+latency + ageFinal + Count_may +(1|nestbox)+ (1 | RFID), data = final_data_glm)
summary(model4)
performance::check_model(model4)
drop1(model3, test = "F")
model3b<-lmer(number_fledged ~ sex*latency + ageFinal + Count_may +(1|nestbox)+ (1 | RFID), data = final_data_glm)
summary(model3b)
drop1(model3, test = "F")
drop1(model3, test = "F")
drop1(model3b, test = "F")
summary(model4)
summary(model4)
model4<-lmer(number_fledged ~ sex+latency + ageFinal + Count_may +(1|nestbox)+ (1 | RFID), data = final_data_glm)
summary(model4)
model4<-lmer(number_fledged ~ sex+latency + ageFinal + Count_may +(1|nestbox)+ (1 | RFID), data = final_data_glm)
summary(model4)
drop1(model3b, test = "F")
model4<-lmer(number_fledged ~ sex+latency + ageFinal + Count_may +(1|nestbox)+ (1 | RFID), data = final_data_glm)
summary(model4)
summary_table5 <-
model4 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#  row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
summary_table5
summary_table8 <-
remove_column(summary_table5,1)
remove_column(summary_table8,1)
print(summary_table8)
remove_column(summary_table8,1)
summary_table1 <-
lsmodel1 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
dplyr::select(-sd__Observation) %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
lsmodel1<-lmer(latency ~  sex*ageFinal+Count_may+(1|nestbox)+ (1 | RFID), data = final_data_glm)  ##need to add fledglings
summary_table1 <-
lsmodel1 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
dplyr::select(-sd__Observation) %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
# remove effect and group
summary_table2 <-
remove_column(summary_table1,1) %>%
remove_column(summary_table2, 1) %>%
# remove rows by cropping
#____________----
#interaction is not significant and can be removed
lsmodel2<-lmer(latency ~  sex+ageFinal+ Count_may+(1|nestbox)+ (1 | RFID), data = final_data_glm)  ##need to add fledglings
summary_table1
summary_table1 <-
lsmodel1 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
dplyr::select(-sd__Observation) %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
# ðŸ“¦PACKAGES ----
library(lme4)
library(lmerTest)
library(rptR)
library(Matrix)
library(tidyverse) # a range of helpful packages
library(janitor)# helps to format the data
library(kableExtra)
library(performance)# needed to instal for the stats graphs (posterior check)
library(ggExtra)
library(broom.mixed) # broom tables
library(patchwork)
library(GGally)
library(gt)
lsmodel1<-lmer(latency ~  sex*ageFinal+Count_may+(1|nestbox)+ (1 | RFID), data = final_data_glm)  ##need to add fledglings
summary(lsmodel1)
lsmodel1 %>%
broom::tidy(conf.int = F)#add 95% conf intervals - doesn't work
performance::check_model(lsmodel1)# seeing the fit of the model,in a image form
drop1(lsmodel1, test = "F")# can look at the AIC, want the smallest AIC
summary_table1 <-
lsmodel1 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
dplyr::select(-sd__Observation) %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
# remove effect and group
summary_table2 <-
remove_column(summary_table1,1) %>%
remove_column(summary_table2, 1) %>%
# remove rows by cropping
#____________----
#interaction is not significant and can be removed
lsmodel2<-lmer(latency ~  sex+ageFinal+ Count_may+(1|nestbox)+ (1 | RFID), data = final_data_glm)  ##need to add fledglings
lsmodel1 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
dplyr::select(-sd__Observation) %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
summary_table1 <-
lsmodel1 %>%
broom::tidy(conf.int = TRUE) %>%
mutate(p.value = scales::pvalue(p.value)) %>% # changes the pvalues <0.001
rename("Term"="term",
"Coefficient" = "estimate", # changing the names to be better
"Standard Error" = "std.error",
"t" = "statistic",
"p value" = "p.value",
"lower.CI" = "conf.low",
"upper.CI" = "conf.high")%>%
mutate(across(c(Coefficient: t), round,5)) %>%
kbl() %>%
kable_styling(latex_options = "hold_position") %>% # to stop the table moving in markdown!!!!
#  row_spec(c(3,5,7), color = 'white', background = 'purple') %>% # the most sig highlighted in colour
row_spec(c(0), italic = TRUE, align = "c") %>% # titles italic
kable_styling() # fancy style
# remove effect and group
summary_table2 <-
remove_column(summary_table1,1) %>%
remove_column(summary_table2, 1) %>%
# remove rows by cropping
#____________----
#interaction is not significant and can be removed
lsmodel2<-lmer(latency ~  sex+ageFinal+ Count_may+(1|nestbox)+ (1 | RFID), data = final_data_glm)  ##need to add fledglings
# remove effect and group
summary_table2 <-
remove_column(summary_table1,1)
remove_column(summary_table2, 1)
